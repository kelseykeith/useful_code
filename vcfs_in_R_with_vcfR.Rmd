---
title: "Untitled"
output: html_document
date: "2024-05-16"
---

```{r setup, include=FALSE}
library(tidyverse)

knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
# pkg <- "pinfsc50"
vcf_file <- system.file("extdata", "pinf_sc50.vcf.gz", package = "pinfsc50")

vcf <- vcfR::read.vcfR(vcf_file)
vcf
```

```{r}
# contains the commented metadata from the head of the VCF file
vcf@meta %>% head()

# fixed information that is contained in all vcf files
vcf@fix %>% head()
vcf@fix %>% class()
vcf@fix %>% as_tibble()

vcf@gt %>% head()
vcf@gt %>% class()

# convert three tables, meta, fix, and genotype to tidy tibbles
vcfR::vcfR2tidy(vcf) -> tidy_vcf

tidy_vcf$fix %>% class()

tidy_vcf$fix %>% head()
tidy_vcf$gt %>% head()

tidy_vcf$fix %>%
  full_join(tidy_vcf$gt, by = join_by('ChromKey', 'POS'))
```
